<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Leason&#39;s Blog</title>
  
  <subtitle>松花酿酒，春水煎茶</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.leason.top/"/>
  <updated>2018-01-26T07:28:05.682Z</updated>
  <id>http://www.leason.top/</id>
  
  <author>
    <name>Leason</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>贰零壹捌</title>
    <link href="http://www.leason.top/2018/01/19/%E8%B4%B0%E9%9B%B6%E5%A3%B9%E6%8D%8C/"/>
    <id>http://www.leason.top/2018/01/19/贰零壹捌/</id>
    <published>2018-01-19T10:02:46.000Z</published>
    <updated>2018-01-26T07:28:05.682Z</updated>
    
    <content type="html"><![CDATA[<p>今天请假把落下的一些事办完，可以闲下来好好回顾这段时间的琐事了。</p><p>精神萎靡不振，心情郁闷至极。</p><p>现在所有节日气氛感受最浓烈的地方，几乎都来自朋友圈，2018也是触不及防的就从朋友圈串到了跟前。可能是由于我并没有准备足够的礼仪来迎接它，比如发个心情，接下来这新官上任的三把火可真让人猝不及防。</p><a id="more"></a><hr><p>年初公司做了信息安全规划，Android移动端进行接口调整需要发布新版本。但是我在调整接口的时候出现了纰漏，忽略了在线更新，导致一部分用户更新到了bug版本，民怨沸腾。领导紧急开会，采取了一系列补救措施，总算是暂时平息了下来。好在影响范围不大啊，不然就只有一首《凉凉》送给我。</p><p>奢望着能借一月中旬公司的年会去去晦气，还真赢得了彩头，我们小组在活动中以绝对的优势获得了一等奖。</p><p>老子曾说“祸兮福之所倚，福兮祸之所伏”，福祸相依的生活辩证法是真的牛逼，不得不承认古人智慧是无穷的。</p><p>接下来的事实证明我还是太年轻。</p><p>周六起床就感冒，但为了人生在世的三大事之一，死撑着出去办资料。</p><p>天公也不作美，头两天可爱的暖阳也害羞躲了起来，只有冬日凌冽的寒风呼呼的刮着。回到楼下连楼梯都爬不动，整个人都是飘的，终于是熬不住了。</p><p>忘了怎么去的药店然后又到家的。只记得38度多的体温，把医生都给惊一跳，“小伙子发着高烧玩呢？还敢在外面浪一天，现在才来拿药”。</p><p>四肢健全的国防身体，居然连体温都驾驭不住。</p><p>在医生的嘱托下，回家洗了个滚烫的热水澡，吃完药躺到被窝里。第二天在床上整整睡了一天。</p><p>直到现在，冬日的流感都还剩下着尾巴，希望它不要太眷恋我的身体，早日离开吧。</p><hr><p>记得以前看过一本书《天才在左，疯子在右》，发高烧时的精神状态就无限接近于疯，脑袋里像把一团蜘蛛丝搅在一起一样，乱作麻。</p><p>当时这本书看到三分之二，便没继续了。我觉得一本书能看完只有两种情况：</p><p> 1、这本书对胃口，能找到共鸣。<br>2、很多人看这本书都有共鸣，你不甘寂寞，认为自己也一定有。</p><p>一千个人眼中有一千个哈姆雷特，但前提是你要能读到哈姆雷特。</p><p>书中作者用一种偏执的做法，把自己放置于精神病的层面，通过与各类病人的对话，键入自己的思想。就算读者发现了逻辑上的不合理，也没办法深究或者反驳，难不成还要去跟一个精神病讲道理？所以后面我就不看了，但书里面有一段话让我印象深刻：</p><blockquote class="blockquote-center">如果你想知道这个世界的本质，那你就要用天的眼睛去看天，云的眼睛去看云，大海的眼睛去看大海，大地的眼睛去看大地。花草树木的眼睛去看花草树木，石头的眼睛去看石头，用人的眼睛去看人。</blockquote> <p>那我用高烧的温度欢迎2018到来，能赐予我狗年的旺旺旺吗？</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天请假把落下的一些事办完，可以闲下来好好回顾这段时间的琐事了。&lt;/p&gt;
&lt;p&gt;精神萎靡不振，心情郁闷至极。&lt;/p&gt;
&lt;p&gt;现在所有节日气氛感受最浓烈的地方，几乎都来自朋友圈，2018也是触不及防的就从朋友圈串到了跟前。可能是由于我并没有准备足够的礼仪来迎接它，比如发个心情，接下来这新官上任的三把火可真让人猝不及防。&lt;/p&gt;
    
    </summary>
    
      <category term="心情" scheme="http://www.leason.top/categories/%E5%BF%83%E6%83%85/"/>
    
    
      <category term="心情" scheme="http://www.leason.top/tags/%E5%BF%83%E6%83%85/"/>
    
  </entry>
  
  <entry>
    <title>如何优雅的使用WebView</title>
    <link href="http://www.leason.top/2018/01/09/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E4%BD%BF%E7%94%A8WebView/"/>
    <id>http://www.leason.top/2018/01/09/如何优雅的使用WebView/</id>
    <published>2018-01-09T01:55:20.000Z</published>
    <updated>2018-01-09T08:24:58.115Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://developer.android.google.cn/reference/android/webkit/WebView.html" target="_blank" rel="noopener"><strong>WiebView</strong></a> 是Android开发中经常会用到的功能，是一个基于webkit引擎，用于显示来自本地、服务器web页面的控件，可以很好的提升应用扩展性。有以下优点：</p><blockquote><ul><li>可以直接显示和渲染web页面</li><li>webview可以直接用html文件（网络上或本地assets中）作布局</li><li>和JavaScript交互调用</li></ul></blockquote><p>基本使用方法在 <a href="https://developer.android.google.cn/reference/android/webkit/WebView.html" target="_blank" rel="noopener"><strong>安卓开发文档</strong></a> 中已经做了相关的详细介绍，这里主要根据日常开发中需求，整理了以下3个方面。</p><a id="more"></a><h3 id="一、处理web页面中的图片点击事件"><a href="#一、处理web页面中的图片点击事件" class="headerlink" title="一、处理web页面中的图片点击事件"></a>一、处理web页面中的图片点击事件</h3><p>在应用中使用 <strong>WebView</strong> 加载网页进行显示的时候，多数情况下都要进行内容适配，这会导致图片进行一定比例的缩小，在手机上看起来模糊，影响用户体验。我们可以提取出网页中的关键图片添加点击事件，然后对图片进行自定义处理，比如：放大、旋转等。</p><h4 id="1-定义JavaScript接口类"><a href="#1-定义JavaScript接口类" class="headerlink" title="1.定义JavaScript接口类"></a>1.定义JavaScript接口类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaScriptInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line">    </span><br><span class="line">    JavaScriptInterface(Context context) &#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//点击图片的回调方法</span></span><br><span class="line">    <span class="comment">//必须添加JavascriptInterface注解,否则无法响应</span></span><br><span class="line">    <span class="meta">@JavascriptInterface</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openImage</span><span class="params">(String img)</span> </span>&#123;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">        <span class="comment">//这里获取到的是图片地址</span></span><br><span class="line">        intent.putExtra(<span class="string">"image"</span>, img);</span><br><span class="line">        <span class="comment">//跳转到图片处理页面</span></span><br><span class="line">        intent.setClass(context, ImageActivity.class);</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-在WebView中添加JavascriptInterface"><a href="#2-在WebView中添加JavascriptInterface" class="headerlink" title="2.在WebView中添加JavascriptInterface"></a>2.在WebView中添加JavascriptInterface</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JavaScriptInterface javascriptInterface = <span class="keyword">new</span> JavaScriptInterface(context);</span><br><span class="line">webview.addJavascriptInterface(javascriptInterface, <span class="string">"imagelistener"</span>);</span><br></pre></td></tr></table></figure><h4 id="3-新建图片遍历和处理的方法"><a href="#3-新建图片遍历和处理的方法" class="headerlink" title="3.新建图片遍历和处理的方法"></a>3.新建图片遍历和处理的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addImageClickListener</span><span class="params">(WebView view)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 遍历所有的img节点,添加onclick函数，函数的功能是在图片点击的时候调用本地java接口并传递url过去</span></span><br><span class="line">        view.loadUrl(<span class="string">"javascript:(function()&#123;"</span> +</span><br><span class="line">                <span class="string">"var objs = document.getElementsByTagName(\"img\"); "</span> +</span><br><span class="line">                <span class="string">"for(var i=0;i&lt;objs.length;i++)  "</span> +</span><br><span class="line">                <span class="string">"&#123;"</span></span><br><span class="line">                + <span class="string">"    objs[i].onclick=function()  "</span> +</span><br><span class="line">                <span class="string">"    &#123;  "</span></span><br><span class="line">                + <span class="string">"        window.imagelistner.openImage(this.src);  "</span> +</span><br><span class="line">                <span class="string">"    &#125;  "</span> +</span><br><span class="line">                <span class="string">"&#125;"</span> +</span><br><span class="line">                <span class="string">"&#125;)()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//循环遍历接收到的数据,提取出带有”img”标签的内容,设置它的宽度占屏幕的100%，图片自适应</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">imgReset</span><span class="params">(WebView view)</span> </span>&#123;</span><br><span class="line">        view.loadUrl(<span class="string">"javascript:(function()&#123;"</span> +</span><br><span class="line">                <span class="string">"var objs = document.getElementsByTagName('img'); "</span> +</span><br><span class="line">                <span class="string">"for(var i=0;i&lt;objs.length;i++)  "</span> +</span><br><span class="line">                <span class="string">"&#123;"</span></span><br><span class="line">                + <span class="string">"var img = objs[i];   "</span></span><br><span class="line">                + <span class="string">"    img.style.maxWidth = '100%';   "</span></span><br><span class="line">                + <span class="string">"    img.style.height = 'auto';   "</span></span><br><span class="line">                + <span class="string">"&#125;"</span> +</span><br><span class="line">                <span class="string">"&#125;)()"</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="4-设置WebViewClient"><a href="#4-设置WebViewClient" class="headerlink" title="4.设置WebViewClient"></a>4.设置WebViewClient</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">webview.setWebViewClient(<span class="keyword">new</span> WebViewClient() &#123;</span><br><span class="line">            <span class="comment">//复写shouldOverrideUrlLoading()方法，设置打开网页时不调用系统浏览器， 直接在WebView中显示</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view, String url)</span> </span>&#123;</span><br><span class="line">                view.loadUrl(url);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageFinished</span><span class="params">(WebView view, String url)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">super</span>.onPageFinished(view, url);</span><br><span class="line">                <span class="comment">// html加载完成之后，添加监听图片的点击js函数</span></span><br><span class="line">                addImageClickListner(view);</span><br><span class="line">                imgReset(view);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        webView.loadData(<span class="string">"&lt;!DOCTYPE html&gt;&lt;title&gt;&lt;/title&gt;"</span>, <span class="string">"text/html"</span>, <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure><p>至此， <strong>WebView</strong>  加载的网页中，图片点击事件处理已经完成。需要注意的是，使用此方法来允许JavaScript控制主机应用程序。这是一个强大的功能，但也为面向JELLY_BEAN或更早版本的应用程序提供安全风险。如果应用程序在运行Android 4.2的设备上运行，那么定位比<a href="https://developer.android.google.cn/reference/android/os/Build.VERSION_CODES.html#JELLY_BEAN" target="_blank" rel="noopener">JELLY_BEAN</a>更晚的版本的应用程序仍然存在漏洞。使用此方法的最安全的方法是将<a href="https://developer.android.google.cn/reference/android/os/Build.VERSION_CODES.html#JELLY_BEAN_MR1" target="_blank" rel="noopener">JELLY_BEAN_MR1</a>作为目标，并确保只有在Android 4.2或更高版本上运行时才会调用该方法。</p><p>使用这些较旧的版本，JavaScript可以使用反射来访问注入对象的公共字段。在包含非信任内容的  <strong>WebView</strong>  中使用此方法可能允许攻击者以非预期的方式操纵主机应用程序，并使用主机应用程序的权限执行Java代码。在可能包含不可信内容的  <strong>WebView</strong>  中使用此方法时要格外小心。</p><h3 id="二、实现web文件下载功能"><a href="#二、实现web文件下载功能" class="headerlink" title="二、实现web文件下载功能"></a>二、实现web文件下载功能</h3><p> <strong>WebView</strong>  控制网页在应用中进行显示的时候，如果碰到下载链接，点击将不会有任何效果，这是因为默认状态下 <strong>WebView</strong> 没有开启文件下载的功能，如果要实现文件下载的功能，需要设置WebView的DownloadListener，自己实现DownloadListener的接口来达到文件的下载。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DownloadListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDownloadStart</span><span class="params">(String url, String userAgent,</span></span></span><br><span class="line"><span class="function"><span class="params">            String contentDisposition, String mimetype, <span class="keyword">long</span> contentLength)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">参数</th><th style="text-align:right">类型</th><th style="text-align:center">释义</th></tr></thead><tbody><tr><td style="text-align:left">url</td><td style="text-align:right">String</td><td style="text-align:center">要下载的内容的完整网址</td></tr><tr><td style="text-align:left">userAgent</td><td style="text-align:right">String</td><td style="text-align:center">用于下载的用户代理</td></tr><tr><td style="text-align:left">contentDisposition</td><td style="text-align:right">String</td><td style="text-align:center">配置http头部信息（如果有的话）</td></tr><tr><td style="text-align:left">mimetype</td><td style="text-align:right">String</td><td style="text-align:center">从服务器获知的内容的MIME类型</td></tr><tr><td style="text-align:left">contentLength</td><td style="text-align:right">long</td><td style="text-align:center">从服务器获知的文件大小</td></tr></tbody></table><h4 id="1-实现DownloadListener接口"><a href="#1-实现DownloadListener接口" class="headerlink" title="1.实现DownloadListener接口"></a>1.实现DownloadListener接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDownLoadListener</span> <span class="keyword">implements</span> <span class="title">DownloadListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line"></span><br><span class="line">    WebViewDownLoadListener(Context mContext) &#123;</span><br><span class="line">        <span class="keyword">this</span>.mContext = mContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDownloadStart</span><span class="params">(String url, String userAgent, String contentDisposition, String mimetype, <span class="keyword">long</span> contentLength)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//这里进行文件下载的处理</span></span><br><span class="line">        <span class="comment">//1、先判断手机是否有SD卡用于存储文件</span></span><br><span class="line">         <span class="keyword">if</span> (!Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)) &#123;</span><br><span class="line">          <span class="comment">//如果没有则提醒用户</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//2、通过url进行文件下载，这里使用的是AsyncTask</span></span><br><span class="line">        DownloaderTask task = <span class="keyword">new</span> DownloaderTask();</span><br><span class="line">        task.execute(url);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="2-新建DownloaderTask-继承AsyncTask并重写其方法"><a href="#2-新建DownloaderTask-继承AsyncTask并重写其方法" class="headerlink" title="2.新建DownloaderTask 继承AsyncTask并重写其方法"></a>2.新建DownloaderTask 继承AsyncTask并重写其方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloaderTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">String</span>, <span class="title">Void</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">       <span class="comment">//文件存储路径（自定义）</span></span><br><span class="line">       String dpath = AppConfig.attach_path;</span><br><span class="line"></span><br><span class="line">       DownloaderTask() &#123;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(String... params)</span> </span>&#123;</span><br><span class="line">           String url = params[<span class="number">0</span>];</span><br><span class="line">           String[] tmpname = url.split(<span class="string">"/"</span>);</span><br><span class="line">           String fileName = tmpname[<span class="number">4</span>] + <span class="string">"_"</span> + url.substring(url.lastIndexOf(<span class="string">"/"</span>) + <span class="number">1</span>);</span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               fileName = URLDecoder.decode(fileName, <span class="string">"UTF-8"</span>);</span><br><span class="line">           &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">           &#125;</span><br><span class="line">           File file = <span class="keyword">new</span> File(dpath, fileName);</span><br><span class="line">           <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">               Log.i(<span class="string">"tag"</span>, <span class="string">"The file has already exists."</span>);</span><br><span class="line">               <span class="keyword">return</span> fileName;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               URL realUrl = <span class="keyword">new</span> URL(url);</span><br><span class="line">               HttpURLConnection conn = (HttpURLConnection)realUrl.openConnection();</span><br><span class="line">               <span class="keyword">if</span> (conn.getResponseCode() == <span class="number">200</span>) &#123;</span><br><span class="line">                   <span class="comment">//获取文件流，并写入SD卡</span></span><br><span class="line">                   InputStream input = conn.getInputStream();</span><br><span class="line">                   writeToSDCard(fileName, input);</span><br><span class="line">                   input.close();</span><br><span class="line">                   <span class="keyword">return</span> fileName;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                   <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">           &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCancelled</span><span class="params">()</span> </span>&#123;</span><br><span class="line">           <span class="keyword">super</span>.onCancelled();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(String result)</span> </span>&#123;</span><br><span class="line">           <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">           <span class="keyword">super</span>.onPostExecute(result);</span><br><span class="line">           <span class="keyword">if</span> (result == <span class="keyword">null</span>) &#123;</span><br><span class="line">               Toast t = Toast.makeText(mContext, <span class="string">"连接错误！请稍后再试！"</span>, Toast.LENGTH_LONG);</span><br><span class="line">               t.setGravity(Gravity.CENTER, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">               t.show();</span><br><span class="line">               <span class="keyword">return</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           Toast t = Toast.makeText(mContext, <span class="string">"已保存到SD卡。"</span>, Toast.LENGTH_LONG);</span><br><span class="line">           t.setGravity(Gravity.CENTER, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">           t.show();</span><br><span class="line"></span><br><span class="line">           File file = <span class="keyword">new</span> File(dpath, result);</span><br><span class="line">           Log.i(<span class="string">"tag"</span>, <span class="string">"Path="</span> + file.getAbsolutePath());</span><br><span class="line">           <span class="comment">//获取intent跳转，打开本地文件</span></span><br><span class="line">           Intent intent = getFileIntent(file);</span><br><span class="line"></span><br><span class="line">           <span class="comment">//捕获异常并处理掉，防止APP崩溃</span></span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               mContext.startActivity(intent);</span><br><span class="line">           &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">               Toast.makeText(mContext, <span class="string">"没有找到可匹配的程序"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPreExecute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">           <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">           <span class="keyword">super</span>.onPreExecute();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onProgressUpdate</span><span class="params">(Void... values)</span> </span>&#123;</span><br><span class="line">           <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">           <span class="keyword">super</span>.onProgressUpdate(values);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h4 id="3-写入文件到本地和打开文件的方法"><a href="#3-写入文件到本地和打开文件的方法" class="headerlink" title="3.写入文件到本地和打开文件的方法"></a>3.写入文件到本地和打开文件的方法</h4><h5 id="3-1-写入文件到本地"><a href="#3-1-写入文件到本地" class="headerlink" title="3.1 写入文件到本地"></a>3.1 写入文件到本地</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeToSDCard</span><span class="params">(String fileName, InputStream input)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)) &#123;</span><br><span class="line">            File file = <span class="keyword">new</span> File(AppConfig.attach_path, fileName);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">                <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">                <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span> ((j = input.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    fos.write(b, <span class="number">0</span>, j);</span><br><span class="line">                &#125;</span><br><span class="line">                fos.flush();</span><br><span class="line">                fos.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Log.i(<span class="string">"tag"</span>, <span class="string">"NO SDCard."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="3-2-打开文件"><a href="#3-2-打开文件" class="headerlink" title="3.2 打开文件"></a>3.2 打开文件</h5><blockquote><p>请注意Android7.0以后权限机制进行了调整，为了提高文件访问的安全性，限制了应用通过file://方式直接对外提供文件路径的功能，向应用外部提供这种uri会直接导致应用崩溃。替代方案是使用FileProvider通过content://方式提供这些uri，并进行临时访问授权，对应的目录要在xml中注册才行。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">private</span> Intent <span class="title">getFileIntent</span><span class="params">(File file)</span> </span>&#123;</span><br><span class="line">        Uri uri = Uri.fromFile(file);</span><br><span class="line">        String type = getMIMEType(file);</span><br><span class="line">        Log.i(<span class="string">"tag"</span>, <span class="string">"type="</span> + type);</span><br><span class="line">        <span class="comment">//判断是否是Android N(7.0)以及更高版本</span></span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW);</span><br><span class="line">        intent.addCategory(<span class="string">"android.intent.category.DEFAULT"</span>);</span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="number">24</span>) &#123;</span><br><span class="line">            <span class="comment">//关于FileProvider的相关配置，这里就不做介绍</span></span><br><span class="line">            intent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);</span><br><span class="line">            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">            Uri contentUri = FileProvider.getUriForFile(mContext, <span class="string">"XXX.YYYY.ZZ.fileProvider"</span>, file);</span><br><span class="line">            intent.setDataAndType(contentUri, type);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">            intent.setDataAndType(uri, type);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> intent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取文件类型</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getMIMEType</span><span class="params">(File f)</span> </span>&#123;</span><br><span class="line">        String type = <span class="string">""</span>;</span><br><span class="line">        String fName = f.getName();</span><br><span class="line">      <span class="comment">/* 取得扩展名 */</span></span><br><span class="line">        String end = fName.substring(fName.lastIndexOf(<span class="string">"."</span>) + <span class="number">1</span>, fName.length()).toLowerCase();</span><br><span class="line">      <span class="comment">/* 依扩展名的类型决定MimeType */</span></span><br><span class="line">        <span class="keyword">switch</span> (end) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"pdf"</span>:</span><br><span class="line">                type = <span class="string">"application/pdf"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"m4a"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"mp3"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"mid"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"xmf"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"ogg"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"wav"</span>:</span><br><span class="line">                type = <span class="string">"audio/*"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"3gp"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"mp4"</span>:</span><br><span class="line">                type = <span class="string">"video/*"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"jpg"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"gif"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"png"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"jpeg"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"bmp"</span>:</span><br><span class="line">                type = <span class="string">"image/*"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"apk"</span>:</span><br><span class="line">        <span class="comment">/* android.permission.INSTALL_PACKAGES */</span></span><br><span class="line">                type = <span class="string">"application/vnd.android.package-archive"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"pptx"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"ppt"</span>:</span><br><span class="line">                type = <span class="string">"application/vnd.ms-powerpoint"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"docx"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"doc"</span>:</span><br><span class="line">                type = <span class="string">"application/msword"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"xlsx"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"xls"</span>:</span><br><span class="line">                type = <span class="string">"application/vnd.ms-excel"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">         <span class="comment">/*如果无法直接打开，就跳出软件列表给用户选择 */</span></span><br><span class="line">                type = <span class="string">"*/*"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="三、处理web页面的弹框"><a href="#三、处理web页面的弹框" class="headerlink" title="三、处理web页面的弹框"></a>三、处理web页面的弹框</h3><p>每个web页面都会有自己的逻辑，其中涉及到弹框的处理，默认情况下，<strong>Android WebView</strong>是不支持 <strong>js</strong> 的Alert(),Confirm(),Prompt()函数的弹出提示框，需要我们设置<a href="https://developer.android.google.cn/reference/android/webkit/WebChromeClient.html" target="_blank" rel="noopener">WebChromeClient</a> 对象来完成。这里我们可以分为以下两种情况来讨论。</p><h4 id="1-不对弹框进行任何处理"><a href="#1-不对弹框进行任何处理" class="headerlink" title="1.不对弹框进行任何处理"></a>1.不对弹框进行任何处理</h4><p>这种很简单，直接设置就行</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webView.setWebChromeClient(<span class="keyword">new</span> WebChromeClient());</span><br></pre></td></tr></table></figure><h4 id="2-处理弹框样式"><a href="#2-处理弹框样式" class="headerlink" title="2.处理弹框样式"></a>2.处理弹框样式</h4><p>重写WebChromeClient的下列方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//警告框</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onJsAlert</span><span class="params">(WebView view, String url, String message, JsResult result)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 这里处理交互逻辑</span></span><br><span class="line">    <span class="comment">// 如果客户端返回true，WebView将假定客户端将处理对话框。如果客户端返回false，它将继续执行</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//确认对话框</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onJsConfirm</span><span class="params">(WebView view, String url, String message, JsResult result)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//提示对话框</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onJsPrompt</span><span class="params">(WebView view, String url, String message, String defaultValue, JsPromptResult result)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//告诉客户端显示一个对话框来确认离开当前页面的导航。这是onbeforeunload javascript事件的结果。</span></span><br><span class="line"><span class="comment">//如果客户端返回true，WebView将假定客户端将处理确认对话框并调用相应的JsResult方法。</span></span><br><span class="line"><span class="comment">//如果客户端返回false，则默认值true将返回到javascript以接受离开当前页面的导航。</span></span><br><span class="line"><span class="comment">//默认行为是返回false。将JsResult设置为true将离开当前页面，false将取消导航。</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onJsBeforeUnload</span><span class="params">(WebView view, String url, String message, JsResult result)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://developer.android.google.cn/reference/android/webkit/WebView.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;WiebView&lt;/strong&gt;&lt;/a&gt; 是Android开发中经常会用到的功能，是一个基于webkit引擎，用于显示来自本地、服务器web页面的控件，可以很好的提升应用扩展性。有以下优点：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;可以直接显示和渲染web页面&lt;/li&gt;
&lt;li&gt;webview可以直接用html文件（网络上或本地assets中）作布局&lt;/li&gt;
&lt;li&gt;和JavaScript交互调用&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;基本使用方法在 &lt;a href=&quot;https://developer.android.google.cn/reference/android/webkit/WebView.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;安卓开发文档&lt;/strong&gt;&lt;/a&gt; 中已经做了相关的详细介绍，这里主要根据日常开发中需求，整理了以下3个方面。&lt;/p&gt;
    
    </summary>
    
      <category term="开发" scheme="http://www.leason.top/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Android" scheme="http://www.leason.top/tags/Android/"/>
    
      <category term="WebView" scheme="http://www.leason.top/tags/WebView/"/>
    
  </entry>
  
  <entry>
    <title>候鸟和鱼</title>
    <link href="http://www.leason.top/2017/12/05/story1/"/>
    <id>http://www.leason.top/2017/12/05/story1/</id>
    <published>2017-12-05T06:56:03.248Z</published>
    <updated>2018-01-19T13:55:03.148Z</updated>
    
    <content type="html"><![CDATA[<h3 id="一"><a href="#一" class="headerlink" title="一"></a>一</h3><p>从一个季节逃到另一个季节需要毅力，需要勇气，甚至是生命。每年这个时候，鱼都会洄游到天的另一端，候鸟也会迁徙到那里，他们起点不同，但终点一样。</p><p>候鸟最喜欢的就是春天了，春天可以见到鱼。他总是会早到，然后在那片水域上空不停振翅，他知道鱼喜欢天空，他便把这里擦亮，让鱼看见最美的天。</p><p>他们每年都会在一起交换各自的故事。<br><a id="more"></a><br>“我给你讲啊，今年可有趣了”<br>“去年的那只螃蟹你还记得吧？今年产了好多小螃蟹，她的海螺家根本住不下”<br>“大峡谷那边又涨潮了”<br>“小黄鱼去了大海深处寻找自由，一直没回来，听说那里暗流湍急，还有水怪”<br>“今年海浪汹涌，没有看见打鱼人出海”</p><p>“我新换了一副羽毛，可以飞得更快更高”<br>“我穿越过暴风雨”<br>“我去过极北的森林，那里花很香，树林茂密，没有猎人”<br>“来的路上我飞上了最高的山峰，很冷，但风景很好。云成海，可以在里面自由穿梭，像软绵绵的棉花糖”</p><p>鱼儿已经沉迷，痴痴的望着蓝天。</p><p>“鱼儿，你为什么向往天空啊？”<br>“我想跟你一起飞，我厌倦了水的束缚，我不想摆动身躯，总觉得这是一种病，拼了命的摇尾乞怜活下去的病。”<br>“带我一起飞，好吗？”</p><p>候鸟没有接话，他知道鱼是属于大海的，就像他属于天空。</p><p>“鱼儿，明年我们各自送对方一件礼物吧”<br>“好啊”</p><p>恰如其分的承诺是打破沉默最好的工具。</p><h3 id="二"><a href="#二" class="headerlink" title="二"></a>二</h3><p>鱼在父亲的鳞片上看过了很多故事，其中描述的最多的是深海的珍珠，纯净如白昼。她决定要找到这颗珍珠送给候鸟。</p><p>这次是她从小到大最陌生的一次出行，她要独自在海底穿过大峡谷，游过深沟，但想到可以和候鸟在春天相遇就不觉得害怕。</p><p>当她快要筋疲力竭的时候，终于在如浓墨般深黑的海中，见到了一抹光亮划破黑夜来到她的眼前，好暖的光啊，像太阳一样。故事是真的，深海的珍珠果然很漂亮。</p><p>候鸟觉得今年时间过得格外的慢，他只想早点飞到那片海域，他后悔了不想让鱼去寻找礼物，因为他这段时间总是做梦。</p><p>他梦见鱼儿游得太远，忘记了回家的路，<br>他梦见鱼儿游得太浅，闯进了坚固的渔网，<br>他梦见鱼儿游得太深，遇到了凶猛的水怪。</p><h3 id="三"><a href="#三" class="headerlink" title="三"></a>三</h3><p>春天终于到来，候鸟在之前精心挑选了刚入冬的链草织成篮子，这个篮子比他的身体大整整两倍。他比往年更早来了一周，把海域上所有的云朵都赶进了篮子里，因为鱼向往天空的自由，便觉云朵是最合适的礼物，虽然日月星辰更好，但他摘不到。</p><p>候鸟看到了最灿烂的珍珠，鱼看到篮子里雪白的云朵。</p><p>满心欢喜。</p><p>这是鱼儿第一次触到云，激动得说不出话来。她觉得这是最好的礼物，最美的云，至少比这片海域上的云要美。她急忙抬头想要对比一下，然而，万里无云。</p><p>“我把你头上这片天空的云朵都装在了这里呀”</p><p>突然间，鱼儿觉得云朵不那么舒服了，至少没有她千辛万苦得到的珍珠白，就像一团乱糟糟的棉絮，陷进去只会让她窒息。</p><p>候鸟不懂，这不是刚刚她喜欢的东西吗？为什么转眼之间，眼里就充满了厌恶。</p><p>“你不喜欢这个礼物？”<br>“喜欢”<br>“最美的云就在你头顶，我把它取来给你，你不开心吗？”<br>“开心”<br>“我每年都迁徙，只有这里云最美，我只想把最美的东西给你”<br>“谢谢你”</p><p>除了谢谢，鱼儿不想再多说一句话。</p><p>候鸟不懂，有时候过程比结果重要得多。</p><p>候鸟不想看到鱼儿不开心，他心想，云朵不好，就只有带她高飞。</p><p>“我带你飞吧”<br>“好啊！”</p><p>终于等来了这一天，候鸟用他有力的双爪带起鱼，他怕锋利的爪伤着鱼儿，但更怕她掉下去，所以他握得很紧。</p><p>离开水面的一瞬间，耀眼的阳光让鱼眯起了眼睛，周围一片雪白，柔软的光线如蚕丝慢慢拨开她的双眼，她听到了风的呼唤，穿过了云的身体。她不愿错过这样的风景哪怕一秒，双眼努力的睁大，嘴也努力的张大，直至忘记了如何去呼吸。</p><h3 id="四"><a href="#四" class="headerlink" title="四"></a>四</h3><p>候鸟认为一定是他的爪子太锋利杀死了鱼，他折断了双脚，他相信一定会有海天相连的地方，那里鸟和鱼可以永远生活在一起，他要一直飞，直到找到那个地方。</p><p>鱼的记忆很短，短到她有时候刚出门就会忘了回家的路，所以每年和候鸟的相遇，她都会像父亲一样，把经历写成故事，刻在自己的鳞片上。这次的故事，该由他来写了。候鸟摘下身上最美的一片羽毛，写上最后的故事，用嘴啄下鱼鳞串成项链戴在脖子上，珍珠被他放在嘴里。</p><p>天空多了一只没有脚，不会叫，也不愿抬头看天的候鸟，在他眼里只有胸前鱼鳞的项链，身下蔚蓝的深海，嘴里纯白的珍珠，远方海天一线的目的地。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;一&quot;&gt;&lt;a href=&quot;#一&quot; class=&quot;headerlink&quot; title=&quot;一&quot;&gt;&lt;/a&gt;一&lt;/h3&gt;&lt;p&gt;从一个季节逃到另一个季节需要毅力，需要勇气，甚至是生命。每年这个时候，鱼都会洄游到天的另一端，候鸟也会迁徙到那里，他们起点不同，但终点一样。&lt;/p&gt;
&lt;p&gt;候鸟最喜欢的就是春天了，春天可以见到鱼。他总是会早到，然后在那片水域上空不停振翅，他知道鱼喜欢天空，他便把这里擦亮，让鱼看见最美的天。&lt;/p&gt;
&lt;p&gt;他们每年都会在一起交换各自的故事。&lt;br&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://www.leason.top/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="故事" scheme="http://www.leason.top/tags/%E6%95%85%E4%BA%8B/"/>
    
  </entry>
  
</feed>
